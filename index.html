<!DOCTYPE html>
<html lang="zh">
<!-- [前面的 HEAD 和 STYLE 部分保持不變] -->

<body>
    <div class="container">
        <!-- [寵物相關的 HTML 保持不變] -->
        
        <!-- 添加語音控制按鈕 -->
        <div class="voice-controls">
            <button class="button" onclick="toggleVoice()" id="voiceButton">
                語音提示：開啟
            </button>
            <button class="button" onclick="adjustVolume()">
                調整音量
            </button>
        </div>
    </div>

    <script>
        // 語音設置
        let voiceEnabled = true;
        let volume = 1.0; // 音量: 0.0 到 1.0
        const speechSynth = window.speechSynthesis;
        let voices = [];

        // 初始化語音
        function initVoices() {
            voices = speechSynth.getVoices();
            // 找尋中文語音
            const chineseVoice = voices.find(voice => 
                voice.lang.includes('zh') || voice.lang.includes('cmn'));
            if (chineseVoice) {
                voices = [chineseVoice];
            }
        }

        // 某些瀏覽器需要等待語音列表載入
        speechSynth.onvoiceschanged = initVoices;
        initVoices();

        // 語音播報功能
        function speak(text) {
            if (!voiceEnabled) return;
            
            // 停止當前的語音
            speechSynth.cancel();

            const utterance = new SpeechSynthesisUtterance(text);
            
            // 設置語音參數
            utterance.volume = volume;  // 音量
            utterance.rate = 0.9;      // 語速稍慢
            utterance.pitch = 1.0;     // 音調
            
            // 使用中文語音
            if (voices.length > 0) {
                utterance.voice = voices[0];
            }
            utterance.lang = 'zh-TW';  // 設置為中文

            speechSynth.speak(utterance);
        }

        // 切換語音開關
        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const button = document.getElementById('voiceButton');
            button.textContent = `語音提示：${voiceEnabled ? '開啟' : '關閉'}`;
            
            if (voiceEnabled) {
                speak('語音提示已開啟');
            }
        }

        // 調整音量
        function adjustVolume() {
            const newVolume = prompt('請輸入音量大小（0-100）：', volume * 100);
            if (newVolume !== null) {
                volume = Math.max(0, Math.min(100, Number(newVolume))) / 100;
                speak(`音量已調整為 ${Math.round(volume * 100)} %`);
            }
        }

        // 修改原有的互動功能，加入語音提示
        function feed() {
            if (hunger < 100) {
                hunger -= 20;
                happiness += 10;
                lastMealTime = new Date();
                if (hunger < 0) hunger = 0;
                if (happiness > 100) happiness = 100;
                updateStatus();
                
                const pet = document.getElementById('pet');
                pet.classList.add('happy');
                setTimeout(() => {
                    pet.classList.remove('happy');
                }, 1000);

                speak('好棒！小狗吃得很開心呢！');
            } else {
                speak('小狗現在不餓喔！');
            }
        }

        function play() {
            if (energy > 0) {
                happiness += 20;
                energy -= 20;
                if (happiness > 100) happiness = 100;
                if (energy < 0) energy = 0;
                updateStatus();

                const pet = document.getElementById('pet');
                pet.classList.add('playing');
                setTimeout(() => {
                    pet.classList.remove('playing');
                }, 2000);

                speak('小狗玩得很開心！繼續保持運動喔！');
            } else {
                speak('小狗累了，需要休息一下');
            }
        }

        function sleep() {
            isSleeping = !isSleeping;
            const pet = document.getElementById('pet');
            if (isSleeping) {
                pet.classList.add('sleeping');
                energy += 30;
                if (energy > 100) energy = 100;
                speak('小狗進入夢鄉了，讓牠好好休息吧');
            } else {
                pet.classList.remove('sleeping');
                speak('小狗醒來了！精神飽滿！');
            }
            updateStatus();
        }

        function bath() {
            happiness += 15;
            if (happiness > 100) happiness = 100;
            updateStatus();

            const pet = document.getElementById('pet');
            pet.style.transform = 'rotate(5deg)';
            setTimeout(() => {
                pet.style.transform = 'rotate(-5deg)';
            }, 200);
            setTimeout(() => {
                pet.style.transform = 'rotate(0deg)';
            }, 400);

            speak('洗香香！保持清潔很重要喔！');
        }

        // 修改定時檢查，加入語音提醒
        setInterval(() => {
            if (!isSleeping) {
                hunger += 5;
                energy -= 2;
                if (hunger > 100) hunger = 100;
                if (energy < 0) energy = 0;
            }

            const now = new Date();
            const timeSinceLastMeal = (now - lastMealTime) / 1000 / 60;

            // 餵食提醒
            if (timeSinceLastMeal >= 1) {
                const reminderText = "該吃飯啦！別讓小狗狗餓著喔！";
                document.getElementById('reminder').innerHTML = reminderText;
                speak(reminderText);
            }

            // 休息提醒
            if (energy < 30) {
                const energyText = "小狗狗累了，該讓它休息了！";
                document.getElementById('reminder').innerHTML += "<br>" + energyText;
                speak(energyText);
            }

            // 時間提醒
            const hour = now.getHours();
            const minute = now.getMinutes();
            
            // 定時提醒吃藥
            if (hour === 8 && minute === 0) {
                speak('早上八點了，該吃早餐和早上的藥囉！');
            }
            if (hour === 12 && minute === 0) {
                speak('中午十二點了，該吃午餐和中午的藥囉！');
            }
            if (hour === 18 && minute === 0) {
                speak('晚上六點了，該吃晚餐和晚上的藥囉！');
            }

            updateStatus();
        }, 30000);

        // 修改點擊寵物的互動
        document.getElementById('pet').addEventListener('click', function() {
            if (!isSleeping) {
                happiness += 5;
                if (happiness > 100) happiness = 100;
                updateStatus();
                
                this.classList.add('happy');
                setTimeout(() => {
                    this.classList.remove('happy');
                }, 500);

                speak('摸摸小狗，好舒服喔！');
            } else {
                speak('噓，小狗正在睡覺呢');
            }
        });

        // 開場歡迎語
        window.onload = function() {
            setTimeout(() => {
                speak('歡迎來到樂齡寵物樂園！我是您的小狗狗，讓我們一起快樂生活吧！');
            }, 1000);
        };
    </script>
</body>
</html>
